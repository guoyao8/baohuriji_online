import{j as e,b as v}from"./index-B2L3e1xg.js";import{u as S,r as t}from"./react-vendor-CA3giask.js";import"./store-DH4KNu1b.js";import"./http-B9ygI19o.js";import"./date-utils-BxdteZ_p.js";function z(){const n=S(),[r,p]=t.useState(""),[l,b]=t.useState(""),[c,g]=t.useState(""),[i,w]=t.useState(!1),[d,j]=t.useState(!1),[o,k]=t.useState(!1),[x,m]=t.useState(!1),[u,s]=t.useState(""),N=async a=>{var h,f;if(a.preventDefault(),s(""),!r.trim()){s("请输入当前密码");return}if(!l.trim()){s("请输入新密码");return}if(l.length<6){s("新密码至少6位");return}if(l!==c){s("两次输入的新密码不一致");return}if(r===l){s("新密码不能与当前密码相同");return}m(!0);try{await v.changePassword({oldPassword:r,newPassword:l}),alert("✅ 密码修改成功，请重新登录"),n("/login")}catch(y){s(((f=(h=y.response)==null?void 0:h.data)==null?void 0:f.error)||"修改失败，请重试")}finally{m(!1)}};return e.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col bg-background-light dark:bg-background-dark font-display overflow-x-hidden",children:[e.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between bg-background-light/80 dark:bg-background-dark/80 px-4 pt-4 pb-3 backdrop-blur-sm",children:[e.jsx("button",{onClick:()=>n(-1),className:"flex h-10 w-10 items-center justify-center rounded-full text-slate-600 dark:text-slate-300",children:e.jsx("span",{className:"material-symbols-outlined text-3xl",children:"arrow_back_ios_new"})}),e.jsx("h1",{className:"flex-1 text-center text-lg font-bold text-slate-900 dark:text-slate-50",children:"修改密码"}),e.jsx("div",{className:"w-10"})]}),e.jsxs("form",{onSubmit:N,className:"flex flex-col gap-6 p-4 pt-6",children:[u&&e.jsx("div",{className:"rounded-lg bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 p-3",children:e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:u})}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-slate-700 dark:text-slate-300 text-sm font-medium",children:"当前密码"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:i?"text":"password",value:r,onChange:a=>p(a.target.value),placeholder:"请输入当前密码",className:"w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 px-4 py-3 pr-12 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-primary/50"}),e.jsx("button",{type:"button",onClick:()=>w(!i),className:"absolute right-0 top-0 flex h-full w-12 items-center justify-center text-slate-400 dark:text-slate-500",children:e.jsx("span",{className:"material-symbols-outlined",children:i?"visibility_off":"visibility"})})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-slate-700 dark:text-slate-300 text-sm font-medium",children:"新密码"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:d?"text":"password",value:l,onChange:a=>b(a.target.value),placeholder:"请输入新密码（至少6位）",className:"w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 px-4 py-3 pr-12 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-primary/50"}),e.jsx("button",{type:"button",onClick:()=>j(!d),className:"absolute right-0 top-0 flex h-full w-12 items-center justify-center text-slate-400 dark:text-slate-500",children:e.jsx("span",{className:"material-symbols-outlined",children:d?"visibility_off":"visibility"})})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-slate-700 dark:text-slate-300 text-sm font-medium",children:"确认新密码"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:o?"text":"password",value:c,onChange:a=>g(a.target.value),placeholder:"请再次输入新密码",className:"w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 px-4 py-3 pr-12 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-primary/50"}),e.jsx("button",{type:"button",onClick:()=>k(!o),className:"absolute right-0 top-0 flex h-full w-12 items-center justify-center text-slate-400 dark:text-slate-500",children:e.jsx("span",{className:"material-symbols-outlined",children:o?"visibility_off":"visibility"})})]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{type:"submit",disabled:x,className:"w-full rounded-xl bg-primary py-3.5 text-base font-bold text-white shadow-lg shadow-primary/20 hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:x?"提交中...":"确认修改"})}),e.jsx("div",{className:"rounded-lg bg-slate-100 dark:bg-slate-800/50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"material-symbols-outlined text-slate-500 dark:text-slate-400 text-xl",children:"info"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 leading-relaxed",children:e.jsx("strong",{className:"font-semibold",children:"密码要求："})}),e.jsxs("ul",{className:"mt-2 space-y-1 text-sm text-slate-600 dark:text-slate-400",children:[e.jsx("li",{children:"• 至少6个字符"}),e.jsx("li",{children:"• 新密码不能与当前密码相同"}),e.jsx("li",{children:"• 修改密码后需要重新登录"})]})]})]})})]})]})}export{z as default};
